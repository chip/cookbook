= Cookbook

Cookbook takes you from a fresh Debian/Ubuntu server to a multi-app Nginx/Mongrel/Rails/PHP/fastcgi/Monit stack using purely Capistrano. Oh yeah, it also takes care of app deployment and pretty much writes your deploy.rb file for you.


== Install

Capify your rails project:

  capify .

Add cookbook as a Git submodule:

  git submodule add git@github.com:winton/cookbook.git config/cookbook

Copy

  config/cookbook/deploy.rb.example
  to
  config/deploy.rb
  
Edit deploy.rb to your liking. Run cap -T to check out your new tasks.


== Set up your fresh Debian server

Log into your server as root. If you can't log in as root directly, but have the password (ServerBeach):

  su

Change root password if you haven't:
  
  passwd

Add a mongrel user:
  
  adduser mongrel

Edit /etc/sudoers:
  
  visudo

Add this line to the end of the file. This gives the mongrel user "sudo without password" privileges:
  
  mongrel ALL=NOPASSWD: ALL

On your machine:
  
  cap debian:setup
  
Its probably a good idea to restart the server after all that:
  
  sudo shutdown -r now
  
To deploy your app:

  cap mysql:create:user
  cap mysql:create:db
  cap deploy:create


TODO
  logrotated
    http://github.com/gabriel/capitate/tree/master/lib/recipes/logrotated.rb
  database cloning
    http://github.com/engineyard/eycap/tree/master/lib/eycap/recipes/database.rb
    http://github.com/smtlaissezfaire/cap_db_dump/tree/master/lib/cap_db_dump/recipes.rb
  monit setup

SOURCES
  http://github.com/gabriel/capitate/tree/master/lib/recipes
  http://github.com/denis/capone/tree/master/recipes
  http://github.com/nakajima/capistrano-bells/tree/master/recipes
  http://github.com/engineyard/eycap/tree/master/lib/eycap/recipes